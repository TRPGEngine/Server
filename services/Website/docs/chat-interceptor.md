---
id: chat-interceptor
title: 聊天消息指令
---

在 `TRPGEngine` 会内置一些自定义的指令，来用于快速投骰操作。这个行为在 `TRPGEngine` 中叫聊天消息拦截，意思是拦截用户发送的信息，如果其满足一定的规则则将其转换为内置的处理。

目前`TRPG Engine`支持的聊天消息拦截器有:

- `/act [消息内容]` 或 `/a [消息内容]`: 发送消息内容, 消息类型强制转化为**动作消息**
- `/speak [消息内容]` 或 `/s [消息内容]`: 发送消息内容, 消息类型强制转化为**会话消息**
- `/ooc [消息内容]`: 发送消息内容, 消息类型强制转化为**OOC 消息**

- `.r[A]d[B]`: 普通投骰, `[A]`为投骰个数(默认为 1)，`[B]`为投骰面数(默认为 100)。 投骰个数的上限为 100, 投骰面数上限为 1000。即最高可在 TRPGEngine 的投骰系统中投出 100 个 1000 面骰, 默认输入`.rd`会投出 1d100

  示例:

  - `.rd`
  - `.r1d100`
  - `.r1d20+4`

- `.rh[A]d[B]`: 暗骰, `[A]`为投骰个数(默认为 1)，`[B]`为投骰面数(默认为 100)。 投骰个数的上限为 100, 投骰面数上限为 1000。即最高可在 TRPGEngine 的投骰系统中投出 100 个 1000 面骰, 默认输入`.rhd`会投出 1d100

  示例:

  - `.rhd`
  - `.rh1d100`
  - `.rh1d20+4`

- `.ra [属性] [数值]`: 判定骰, `[属性]`如果没有指定数值则会尝试从角色卡的数据中查找, 查找的数值与人物卡数据存储的方式有关, 如果指定了数值则会按照指定数值来判定, 如果投骰结果**小于**判定数值则视为成功。_注意中间要用空格进行分割_

  示例:

  - `.ra 50`
  - `.ra 力量 50`
  - `.ra 力量`

- `.ww<A>[a<B>]`: 无限骰, `<A>`为初始骰数，对初始骰数投出`<A>d10`个结果，如果结果中有大于等于`<B>(默认10)`值则可以相应额外投骰直到没有满足重骰数的值。 `<B>`为重骰值, **5≤`<B>`≤10**

  示例:

  - `.ww5`
  - `.ww5a8`

* `.rf`: 命运骰, 泛用规则 投骰结果如`[+ - 0 +] = 1`

  示例:

  - `.rf`

## FAQ

为什么我输入`.r 2d6`没有办法投掷出两数之和?
- 因为`TRPG Engine`把它视为了`.rd 2d6`, 即`2d6`视为了投骰的原因描述。因此实际投出的结果是`rd100`的结果。
  请使用`.r2d6`作为替代

为什么输入`.rd5d6d7`的结果这么奇怪?
- 因为`TRPG Engine`的内部算法将d左右两边的数字解析后放入原表达式进行数据合并计算。一般情况下`.rd5+d6+d7`会给出类似`d5+d6+d7=3+4+6=13`的正常结果。因此请使用正常的数学表达式。
